import{e as _,f as h,r as u,g as L,o as a,c as l,a as e,F as w,h as D,i as $,b as k,t as x,n as z,j as A,u as N,w as V,v as j,k as B,d as F}from"./index-CCi5qPXc.js";const M="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20enable-background='new%200%200%2024%2024'%20height='24px'%20viewBox='0%200%2024%2024'%20width='24px'%20fill='%235f6368'%3e%3cg%3e%3crect%20fill='none'%20height='24'%20width='24'/%3e%3c/g%3e%3cg%3e%3cpath%20d='M12%202C6.48%202%202%206.48%202%2012s4.48%2010%2010%2010%2010-4.48%2010-10S17.52%202%2012%202zm0%204c1.93%200%203.5%201.57%203.5%203.5S13.93%2013%2012%2013s-3.5-1.57-3.5-3.5S10.07%206%2012%206zm0%2014c-2.03%200-4.43-.82-6.14-2.88C7.55%2015.8%209.68%2015%2012%2015s4.45.8%206.14%202.12C16.43%2019.18%2014.03%2020%2012%2020z'/%3e%3c/g%3e%3c/svg%3e",p="https://todolist-api.hexschool.io";function I(){return _.get(`${p}/todos`,{headers:{Authorization:h.getCookie("todoToken")}})}function O(i){return _.post(`${p}/todos`,{content:i},{headers:{Authorization:h.getCookie("todoToken")}})}function U(i,g){return _.put(`${p}/todos/${i}`,{content:g},{headers:{Authorization:h.getCookie("todoToken")}})}function E(i){return _.patch(`${p}/todos/${i}/toggle`,null,{headers:{Authorization:h.getCookie("todoToken")}})}function R(i){return _.delete(`${p}/todos/${i}`,{headers:{Authorization:h.getCookie("todoToken")}})}const y={getToDoList:I,addToDo:O,editToDo:U,toggleToDo:E,deleteToDo:R},q={class:"nav py-3 d-flex justify-content-around rounded"},G=["onClick"],H={class:"list-group"},J=["checked","onClick"],K=["onClick"],P={key:0,class:"no-item text-center rounded py-4 mx-4"},Q=e("br",null,null,-1),W={key:1,class:"no-item text-center rounded py-4 mx-4"},X={key:2,class:"alert mx-4 mt-3 text-end"},Y={key:3,class:"alert mx-4 mt-3 text-end"},Z={__name:"TodoList",setup(i,{expose:g}){let o=[];const s=u([]),m=u(["All","ToDo","Done"]),n=u(0),c=u(0);L(()=>{v()});async function f(){try{return(await y.getToDoList()).data.data}catch(t){console.log(t.response)}}async function C(t){try{await y.toggleToDo(t.id),v()}catch(d){console.log(d.response),alert(`Failed, ${d.response}`)}}async function b(t){try{await y.deleteToDo(t.id),alert("Delete success"),v()}catch(d){console.log(d.response),alert(`刪除失敗，${d.response.data.message}`)}}function S(t){n.value=m.value.indexOf(t),v()}async function v(){o=await f(),n.value===1?s.value=o.filter(t=>t.status===!1):n.value===2?s.value=o.filter(t=>t.status===!0):s.value=o,c.value=o.filter(t=>t.status===!1).length}return g({handleStatusChange:v}),(t,d)=>(a(),l(w,null,[e("ul",q,[(a(!0),l(w,null,D(m.value,(r,T)=>(a(),l("li",{class:"nav-item",key:r},[e("a",{href:"#",class:z(n.value===T?"underline":""),onClick:A(ie=>S(r),["prevent"])},x(r),11,G)]))),128))]),e("ul",H,[(a(!0),l(w,null,D(s.value,r=>(a(),l("li",{class:"list-group-item d-flex justify-content-between",key:r.id},[e("div",null,[e("input",{type:"checkbox",name:"",id:"",class:"me-2",checked:r.status,onClick:T=>C(r)},null,8,J),$(" "+x(r.content),1)]),e("div",{class:"delete-btn rounded px-2",onClick:T=>b(r)},"x",8,K)]))),128))]),s.value.length===0&&n.value!==2?(a(),l("div",P,[$(" No items to do."),Q,$("Start adding a new task! ")])):k("",!0),s.value.length===0&&n.value===2?(a(),l("div",W," No finished item. ")):k("",!0),n.value!==0?(a(),l("div",X,"Total items: "+x(s.value.length),1)):k("",!0),n.value===0?(a(),l("div",Y," Unfinished items: "+x(c.value),1)):k("",!0)],64))}},ee={class:"container d-flex flex-column align-items-center"},te=e("img",{src:M,alt:"user icon",class:"icon me-1"},null,-1),oe=e("span",{class:"nickname me-4"},"User",-1),se=e("h1",{class:"title m-4"},"TODO   LIST",-1),ne={class:"wrap"},ae={class:"d-flex mb-5"},le={class:"todo-wrap rounded"},re={__name:"TodoView",setup(i){const g=N(),o=u(""),s=u(null);async function m(){try{await y.addToDo(o.value),s.value.handleStatusChange(),o.value=""}catch(c){console.log(c.response),alert(`Fail, ${c.response.data.message}`)}}async function n(){try{await F.logout(),h.cleanCookie("todoToken"),g.push("/")}catch(c){console.log(c.response),alert(`送出失敗，${c.response.data.message}`)}}return(c,f)=>(a(),l("div",ee,[e("div",{class:"user-set d-flex justify-content-end my-2"},[te,oe,e("div",{class:"logout-btn",onClick:n},"Logout")]),se,e("div",ne,[e("div",ae,[V(e("input",{type:"text",class:"form-control me-2",id:"add-list",placeholder:"Add A New Task","onUpdate:modelValue":f[0]||(f[0]=C=>o.value=C)},null,512),[[j,o.value]]),e("button",{type:"button",class:"btn",onClick:m},"+")]),e("div",le,[B(Z,{ref_key:"todoListComponent",ref:s},null,512)])])]))}};export{re as default};
